<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="prev" title="Stout Case Studies" href="../index.html" />

    <meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>Case Study 1 - Stout Case Studies</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Stout Case Studies</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Stout Case Studies</span>
  
</a>
<div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Case Studies</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Case Study 1</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="case-study-1">
<h1>Case Study 1<a class="headerlink" href="#case-study-1" title="Permalink to this headline">¶</a></h1>
<p>This study had the goal of predicting interest rates, using data from Lending Club,
a peer-to-peer lending platform.</p>
<section id="eda">
<h2>EDA<a class="headerlink" href="#eda" title="Permalink to this headline">¶</a></h2>
<p>Below are visualizations which give insight into the dataset, giving clues as to which
approaches may be successful for interest rate prediction.</p>
<section id="geographic-loan-distribution">
<h3>Geographic Loan Distribution<a class="headerlink" href="#geographic-loan-distribution" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="./files/us_heatmap.png"><img alt="United States Loan Heatmap" src="../_images/us_heatmap.png"/></a>
<p>The number of loan applications looks to be roughly proportional to the overall
population of the state. We will remove state from consideration as a feature, as
it would result in 50 extra features, one-hot encoded. This would result in
unnecessarily long training times.</p>
</section>
<section id="interest-rate-distribution">
<h3>Interest Rate Distribution<a class="headerlink" href="#interest-rate-distribution" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="./files/interest_distribution.png"><img alt="Interest Rate Distribution" src="../_images/interest_distribution.png"/></a>
<p>Interest rate follows what looks to be a rough beta distribution. The graph looks
to be missing bars, which led to the observation that interest rate is, in fact, a
categorical variable. This was confirmed <a class="reference external" href="https://www.lendingclub.com/investing/investor-education/interest-rates-and-fees">online</a>. This was also
confirmed by grouping <code class="docutils literal notranslate"><span class="pre">sub_grade</span></code> in the data, and displaying interest rates. Part
of that table is shown below.</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub-grade</p></th>
<th class="head"><p>Interest Rates</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A1</p></td>
<td><p>[5.23, 5.31]</p></td>
</tr>
<tr class="row-odd"><td><p>A2</p></td>
<td><p>[6.08, 6.07, 6.0]</p></td>
</tr>
<tr class="row-even"><td><p>A3</p></td>
<td><p>[6.72, 6.71]</p></td>
</tr>
<tr class="row-odd"><td><p>A4</p></td>
<td><p>[7.34, 7.35]</p></td>
</tr>
<tr class="row-even"><td><p>A5</p></td>
<td><p>[7.96, 7.97]</p></td>
</tr>
</tbody>
</table></div>
<p><code class="docutils literal notranslate"><span class="pre">sub_grade</span></code> needs to be removed from our feature set. In a practical application, if we
have access to sub-grade, a simple rule-based model will yield near perfect
predictions as the mapping to interest rate is almost one to one. The decision to
leave or keep this feature would depend on the model use case in real life. In
this case study, I exclude it, as a ML model learning a near one-to-one mapping
is wasteful (and frankly boring), and it is much more interesting to try and use the
rest of the rich feature set to predict interest rates.</p>
</section>
<section id="a-note-on-application-type">
<h3>A Note on <code class="docutils literal notranslate"><span class="pre">application_type</span></code><a class="headerlink" href="#a-note-on-application-type" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="./files/application_type_pie.png"><img alt="Application Type Pie Char" src="../_images/application_type_pie.png"/></a>
<p>85% of applications are individual. This makes sense, as the features
related to joint applications, <code class="docutils literal notranslate"><span class="pre">annual_income_joint</span></code>, <code class="docutils literal notranslate"><span class="pre">verification_income_joint</span></code>,
<code class="docutils literal notranslate"><span class="pre">debt_to_income_joint</span></code> all had around 85% of their values missing.</p>
</section>
<section id="identifying-possible-relations">
<h3>Identifying Possible Relations<a class="headerlink" href="#identifying-possible-relations" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="./files/open_cc_accts.png"><img alt="Open CC Accounts" src="../_images/open_cc_accts.png"/></a>
<a class="reference external image-reference" href="./files/debt_limit_relation.png"><img alt="Debt Limi" src="../_images/debt_limit_relation.png"/></a>
<p>There look to be weak and possibly non-linear relations between both
<code class="docutils literal notranslate"><span class="pre">num_open_cc_accounts</span></code> and <code class="docutils literal notranslate"><span class="pre">total_debt_limit</span></code> and <code class="docutils literal notranslate"><span class="pre">interest_rate</span></code>.</p>
</section>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h2>
<p>Preprocessing consisted of the following:</p>
<ul class="simple">
<li><p>Deletion of bloated/useless features</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">emp_title</span></code>: there are apx. 4500 of these titles. Not very insightful w/o further processing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">state</span></code>: see EDA</p></li>
</ul>
</li>
<li><p>Deletion of grade-related features</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">grade</span></code> and <code class="docutils literal notranslate"><span class="pre">sub_grade</span></code>: see EDA</p></li>
</ul>
</li>
<li><p>One-hot Encoding of Categorical Features</p>
<ul>
<li><p>Allows model to work with non-numerical data</p></li>
</ul>
</li>
<li><p>Train/Test Split</p>
<ul>
<li><p>20% of the data used as a validation set</p></li>
<li><p>Given more time, would evaluate models using cross-validation</p></li>
</ul>
</li>
</ul>
<p>These pre-processing steps were performed for both the train set, and test set, but
separately as to not introduce unintended biases to the model.</p>
<ul class="simple">
<li><p>Null Value Replacement</p>
<ul>
<li><p>For values in the columns <code class="docutils literal notranslate"><span class="pre">{'emp_length',</span> <span class="pre">'debt_to_income',</span> <span class="pre">'annual_income_joint',</span> <span class="pre">'debt_to_income_joint'}</span></code>, null values were replaced with the feature mean</p></li>
<li><p>For values in the columns <code class="docutils literal notranslate"><span class="pre">{'months_since_last_delinq',</span> <span class="pre">'months_since_90d_late',</span> <span class="pre">'months_since_last_credit_inquiry'}</span></code> these were filled with a number of months equivalent to 150 years, much longer than a normal human lifespan</p></li>
<li><p>All other values were filled with 0</p></li>
</ul>
</li>
<li><p>Standardization</p>
<ul>
<li><p>Training sets were standardized</p></li>
</ul>
</li>
</ul>
</section>
<section id="interest-rate-prediction-as-a-classification-problem">
<h2>Interest Rate Prediction as a Classification Problem<a class="headerlink" href="#interest-rate-prediction-as-a-classification-problem" title="Permalink to this headline">¶</a></h2>
<p>Initially, I approached this a classfication problem. Below is a table of model
results on the validation set (0-1 Loss). Evidently, this approach was a spectacular failure.</p>
<div class="table-wrapper"><table class="docutils align-default">
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>Validation Score</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SVC</p></td>
<td><p>11.70%</p></td>
</tr>
<tr class="row-odd"><td><p>KNN(k=3)</p></td>
<td><p>5.75%</p></td>
</tr>
<tr class="row-even"><td><p>NN</p></td>
<td><p>4.05%</p></td>
</tr>
</tbody>
</table></div>
<p><em>Neural net used linear layers with ReLU activation functions.</em></p>
</section>
<section id="interest-rate-predicion-as-a-regression-problem">
<h2>Interest Rate Predicion as a Regression Problem<a class="headerlink" href="#interest-rate-predicion-as-a-regression-problem" title="Permalink to this headline">¶</a></h2>
<a class="reference external image-reference" href="./files/training_loss_normal.png"><img alt="Training Loss Graph" src="../_images/training_loss_normal.png"/></a>
<p>I then approached the problem as a regression. This proved more fruitful. I only had
the time to run one approach, a NN, which resulted in a RMSE on the validation set of
2.97 percentage points. With more time I would run more regression models to try and find a better solution. The RMSE while training is shown above.</p>
<section id="including-sub-grade-and-grade">
<h3>Including <code class="docutils literal notranslate"><span class="pre">sub_grade</span></code> and <code class="docutils literal notranslate"><span class="pre">grade</span></code><a class="headerlink" href="#including-sub-grade-and-grade" title="Permalink to this headline">¶</a></h3>
<a class="reference external image-reference" href="./files/training_loss_oneone.png"><img alt="Training Loss Graph" src="../_images/training_loss_oneone.png"/></a>
<p>As mentioned in the EDA, including <code class="docutils literal notranslate"><span class="pre">sub_grade</span></code> and <code class="docutils literal notranslate"><span class="pre">grade</span></code> greatly improved model RMSE,
resulting in a validation RMSE of 0.407 percentage points. The RMSE while training is shown above.</p>
</section>
</section>
<section id="assumptions-made">
<h2>Assumptions Made<a class="headerlink" href="#assumptions-made" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sub_grade</span></code> and <code class="docutils literal notranslate"><span class="pre">grade</span></code> should not be used in interest rate prediction</p></li>
<li><p>All features required to accurately predict interest rate are
contained within the dataset</p></li>
<li><p>The treatment of null-values as described in the pre-processing section results in good model performance. This is something else I would experiment with given time</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="../index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, Martin Michalski |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="../_sources/case-studies/CaseStudy1.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Case Study 1</a><ul>
<li><a class="reference internal" href="#eda">EDA</a><ul>
<li><a class="reference internal" href="#geographic-loan-distribution">Geographic Loan Distribution</a></li>
<li><a class="reference internal" href="#interest-rate-distribution">Interest Rate Distribution</a></li>
<li><a class="reference internal" href="#a-note-on-application-type">A Note on <code class="docutils literal notranslate"><span class="pre">application_type</span></code></a></li>
<li><a class="reference internal" href="#identifying-possible-relations">Identifying Possible Relations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li><a class="reference internal" href="#interest-rate-prediction-as-a-classification-problem">Interest Rate Prediction as a Classification Problem</a></li>
<li><a class="reference internal" href="#interest-rate-predicion-as-a-regression-problem">Interest Rate Predicion as a Regression Problem</a><ul>
<li><a class="reference internal" href="#including-sub-grade-and-grade">Including <code class="docutils literal notranslate"><span class="pre">sub_grade</span></code> and <code class="docutils literal notranslate"><span class="pre">grade</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#assumptions-made">Assumptions Made</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/main.js"></script>
    </body>
</html>